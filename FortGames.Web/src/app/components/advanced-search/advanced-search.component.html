<div class="py-3">
  <h1 class="mat-display-1 mb-0 fw-bold">Advanced Search</h1>
</div>

<mat-form-field appearance="standard" class="w-100 fs-5">
  <mat-label>Search</mat-label>

  <input matInput placeholder="Enter a search term here" type="text" [(ngModel)]="value" (keyup)="searchFilter($event)"
    #input>
  <div matPrefix>
    <button mat-icon-button class="fs-6 text-muted">
      <mat-icon>search</mat-icon>
    </button>
  </div>
  <div *ngIf="value" matSuffix class="d-flex align-items-center gap-3">
    <button mat-icon-button (click)="value=''; searchFilter($event)">
      <mat-icon>close</mat-icon>
    </button>
    <p class="text-muted mb-0">Found {{ total }} items</p>
  </div>
</mat-form-field>

<mat-tab-group animationDuration="0">
  <mat-tab label="Platforms">
    <div class="py-4 filter-elements px-3 mb-3">
      <mat-chip-list multiple>
        <mat-chip #c="matChip" *ngFor="let platform of platforms" (click)="toggle(c)" [value]="platform">
          {{ platform.name }}
        </mat-chip>
      </mat-chip-list>
    </div>
  </mat-tab>

  <mat-tab label="Genre">
    <div class="py-4 filter-elements px-3 mb-3">
      <mat-chip-list multiple>
        <mat-chip #c="matChip" *ngFor="let genre of genres" (click)="toggle(c)" [value]="genre">
          {{ genre.name }}
        </mat-chip>
      </mat-chip-list>
    </div>
  </mat-tab>

  <mat-tab label="Mode">
    <div class="py-4 filter-elements px-3 mb-3">
      <mat-chip-list multiple>
        <mat-chip #c="matChip" *ngFor="let mode of modes" (click)="toggle(c)" [value]="mode">
          {{ mode.name }}
        </mat-chip>
      </mat-chip-list>
    </div>
  </mat-tab>


  <mat-tab label="Companies">
    <div class="py-4 filter-elements px-3 mb-3">
      <mat-chip-list multiple>
        <mat-chip #c="matChip" *ngFor="let company of companies" (click)="toggle(c)" [value]="company">
          {{ company.name }}
        </mat-chip>
      </mat-chip-list>
    </div>
  </mat-tab>
</mat-tab-group>

<div>
  <mat-chip-list>
    <mat-chip *ngFor="let chip of chips" (removed)="toggle(chip)">
      {{ chip.value.name }}
      <button matChipRemove>
        <mat-icon>cancel</mat-icon>
      </button>
    </mat-chip>
  </mat-chip-list>
</div>

<div class="d-flex justify-content-between align-items-center mt-3">
  <div matSort (matSortChange)="sortChange($event)" class="d-flex gap-2">

    <button mat-flat-button>
      <div mat-sort-header="Title">Title</div>
    </button>
    <button mat-flat-button>
      <div mat-sort-header="Release">Release</div>
    </button>
    <button mat-flat-button>
      <div mat-sort-header="Rating">Rating</div>
    </button>

  </div>
  <div class="d-lg-flex align-items-center gap-3 d-none ">
    <div class="text-muted">Display options:</div>
    <button mat-mini-fab color="accent" (click)="viewEvent(); iconEvent()">
      <mat-icon>{{icon}}</mat-icon>
    </button>
  </div>
</div>

<div class="row">

  <div *ngFor="let game of filteredData; let i=index" [ngClass]="status ? ['col-lg-12'] : ['col-lg-3']"
    class="col-md-6 g-4">
    <div class="card bg-dark game-card" [ngClass]="status ? ['col-lg-6','mx-auto'] : ['w-100']">
      <img src="./../../../assets/placeholder_featured_image.svg" class="card-img-top game-img-card">
      <div class="card-body">
        <div class="d-flex justify-content-between">
          <div class="d-flex">
            <div *ngFor="let platforms of game.platforms; let i=index" class="game-platforms text-muted">
              {{platforms.name}}{{i === game.platforms.length - 1 ? '' : '&nbsp;/&nbsp;'}}
            </div>
          </div>
          <div
            [ngClass]="(game.rating > 7 ) ? ['text-success', 'border-success'] : (game.rating > 5) ? ['text-warning','border-warning'] : ['text-danger','border-danger']"
            class="rating d-flex align-items-center justify-content-center">{{ game.rating}}</div>
        </div>
        <h2 class="card-title">{{game.title}}</h2>
        <div class="d-flex align-items-center gap-1 pb-2 ">
          <button mat-flat-button>
            <mat-icon class="text-light" style="transform: scale(80%);">add</mat-icon>
          </button>
          <button mat-flat-button>
            <mat-icon class="text-light" style="transform: scale(80%);">thumb_up</mat-icon>
          </button>
          <button mat-icon-button>
            <mat-icon class="text-light" style="transform: scale(80%);">more_vert</mat-icon>
          </button>
        </div>
        <div class="d-flex justify-content-between mat-caption">
          <span class="text-muted">Release date: </span>
          <div class="card-text">{{game.release | date:'mediumDate'}}</div>
        </div>
        <hr class="text-muted my-2">
        <div class="d-flex justify-content-between mat-caption">
          <span class="text-muted">Genres: </span>
          <div>
            <span class="card-text text-end" *ngFor="let genres of game.genres; let i=index"><a routerLink="/advanced_search" class="text-light">{{genres.name}}</a>{{i ===
              game.genres.length - 1 ? '' : ',&nbsp;'}}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="filteredData.length === 0" class="text-light">
  <div class="py-5 lead text-muted">No games found "{{input.value}}"</div>
</div>

<mat-paginator [pageSizeOptions]="pageSizeOptions" [pageSize]="params.size" [length]="total"
  (page)="pageChanged($event)" color="accent">
</mat-paginator>


<!-- <div *ngIf="dataSource">

  <table mat-table [dataSource]="dataSource" matSort (matSortChange)="sortChange($event)" class="w-100">

    <ng-container matColumnDef="Logo">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Logo</th>
      <td mat-cell *matCellDef="let element"><img src="https://source.unsplash.com/100x100/?{{element.company}}"> {{element.title}}</td>
    </ng-container>

    <ng-container matColumnDef="Title">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Title</th>
      <td mat-cell *matCellDef="let element">{{element.title}}</td>
    </ng-container>

    <ng-container matColumnDef="Release">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Release</th>
      <td mat-cell *matCellDef="let element">{{element.release}}</td>
    </ng-container>

    <ng-container matColumnDef="Rating">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Rating</th>
      <td mat-cell *matCellDef="let element">{{element.rating}}</td>
    </ng-container>

    <ng-container matColumnDef="Platforms">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Platforms</th>
      <td mat-cell *matCellDef="let element"> <div *ngFor="let x of element.platforms; let i = index">{{ element.platforms[i].name}}</div>
        </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

    <tr *matNoDataRow class="text-light">
      <td class="px-3">No games found "{{input.value}}"</td>
    </tr>
  </table>

  <mat-paginator [pageSizeOptions]="pageSizeOptions" [pageSize]="params.size" [length]="total" (page)="pageChanged($event)" showFirstLastButtons>
  </mat-paginator>

</div> -->
